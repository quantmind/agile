from .settings import *

from pulsar.utils.log import LOGGING_CONFIG as logconfig

redis_server = 'redis://{{ redis_host }}:{{ redis_port }}'
CACHE_SERVER = '%s/3' % redis_server
PUBSUB_STORE = data_store = '%s/4' % redis_server

logconfig['handlers']['file'] = {
    'class': 'logging.FileHandler',
    'formatter': 'verbose',
    'filename': '{{ service_log_path }}/{{ item.name }}.log'
}

{% if item.port is defined %}
bind = ':{{ item.port }}'
{% endif %}

{% if item.workers is defined %}
workers = {{ item.workers }}
{% endif %}

process_name = '{{ service_user}}.{{ item.name }}'

pidfile = '{{ install_dir }}/{{ item.name }}.pid'

daemon = True

{% if item.template is defined %}
{% include item.template %}{% endif %}
